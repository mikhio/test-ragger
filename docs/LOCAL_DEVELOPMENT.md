# üõ†Ô∏è –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å Docker Qdrant

> [‚Üê –ù–∞–∑–∞–¥ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](README.md) | [üè† –ì–ª–∞–≤–Ω–∞—è](../README.md)

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 1. –ó–∞–ø—É—Å–∫ Docker Desktop
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Docker Desktop –∑–∞–ø—É—â–µ–Ω –Ω–∞ –≤–∞—à–µ–º Mac.

### 2. –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞
```bash
cp env-example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` —Ñ–∞–π–ª –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤–∞—à OpenAI API –∫–ª—é—á:
```bash
OPENAI_API_KEY=sk-your-actual-api-key-here
```

### 3. –ó–∞–ø—É—Å–∫ Qdrant –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –ó–∞–ø—É—Å–∫ Qdrant –≤ —Ñ–æ–Ω–µ
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs qdrant
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Qdrant
- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: http://localhost:6333/dashboard
- **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: http://localhost:6333/docs
- **gRPC endpoint**: localhost:6334 (–¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
go build -o bin/test-ragger ./cmd/test-ragger
```

### –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–∞ HTML —Ñ–∞–π–ª–∞
./bin/test-ragger -mode=ingest -dir=./html

# –ò–ª–∏ —Å go run –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
go run ./cmd/test-ragger -mode=ingest -dir=./html
```

### –ü–æ–∏—Å–∫ –ø–æ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º
```bash
# –ü–æ–∏—Å–∫ —Å –±–∞–∑–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
./bin/test-ragger -mode=search -q="–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ" -k=5

# –ü–æ–∏—Å–∫ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
./bin/test-ragger -mode=search -q="–Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏" -k=10 -lang=ru

# –° go run –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
go run ./cmd/test-ragger -mode=search -q="–≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö" -k=3
```

## –û—Ç–ª–∞–¥–∫–∞ –≤ IDE

### VS Code
1. –°–æ–∑–¥–∞–π—Ç–µ `.vscode/launch.json`:
```json
{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "Debug Ingest",
            "type": "go",
            "request": "launch",
            "mode": "auto",
            "program": "${workspaceFolder}/cmd/test-ragger",
            "args": ["-mode=ingest", "-dir=./html"],
            "env": {}
        },
        {
            "name": "Debug Search",
            "type": "go",
            "request": "launch",
            "mode": "auto",
            "program": "${workspaceFolder}/cmd/test-ragger",
            "args": ["-mode=search", "-q=–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ", "-k=5"],
            "env": {}
        }
    ]
}
```

2. –ü–æ—Å—Ç–∞–≤—å—Ç–µ –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç—ã –≤ –∫–æ–¥–µ
3. –ù–∞–∂–º–∏—Ç–µ F5 –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ—Ç–ª–∞–¥–∫–∏

### GoLand/IntelliJ
1. –°–æ–∑–¥–∞–π—Ç–µ Run Configuration
2. Program: `cmd/test-ragger`
3. Arguments: `-mode=search -q="–≤–∞—à –∑–∞–ø—Ä–æ—Å" -k=5`
4. Working directory: –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### Docker —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ Qdrant
docker-compose down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Qdrant
docker-compose restart

# –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (—É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤)
docker-compose down -v

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker-compose logs -f qdrant
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è Qdrant
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ curl
curl http://localhost:6333/collections

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ docs
curl http://localhost:6333/collections/docs
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –≤ Qdrant —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–ª–ª–µ–∫—Ü–∏—è `docs` —Å –≤–µ–∫—Ç–æ—Ä–∞–º–∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å—é 1536 (OpenAI embeddings).

–ö–∞–∂–¥—ã–π –≤–µ–∫—Ç–æ—Ä —Å–æ–¥–µ—Ä–∂–∏—Ç payload:
- `title` - –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `text` - —Ç–µ–∫—Å—Ç —á–∞–Ω–∫–∞
- `path` - –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
- `lang` - —è–∑—ã–∫ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ Qdrant
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Docker –∑–∞–ø—É—â–µ–Ω: `docker ps`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç—ã: `lsof -i :6333,6334`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Qdrant: `docker-compose restart qdrant`

### –ü—Ä–æ–±–ª–µ–º—ã —Å OpenAI API
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª –∏ API –∫–ª—é—á
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ —Å—á–µ—Ç—É OpenAI
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–æ–¥–µ–ª—å `text-embedding-3-small` –¥–æ—Å—Ç—É–ø–Ω–∞

### –ü—É—Å—Ç—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏—é –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Qdrant
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–∏–µ –ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
