# üìã Makefile –®–ø–∞—Ä–≥–∞–ª–∫–∞

> [‚Üê –ù–∞–∑–∞–¥ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](README.md) | [üè† –ì–ª–∞–≤–Ω–∞—è](../README.md)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
make setup                          # –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
make docker-up                      # –ó–∞–ø—É—Å–∫ Qdrant
export OPENAI_API_KEY=sk-...        # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ API –∫–ª—é—á–∞
make ingest                         # –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è HTML —Ñ–∞–π–ª–æ–≤
make search Q="–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ"   # –ü–æ–∏—Å–∫
```

## üìñ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ —Å–±–æ—Ä–∫–∞
```bash
make setup        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ + –∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
make build        # –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
make build-clean  # –ß–∏—Å—Ç–∞—è —Å–±–æ—Ä–∫–∞ (—Å –æ—á–∏—Å—Ç–∫–æ–π)
make deps         # –¢–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
# –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è
make ingest                              # –ë–∞–∑–æ–≤–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è
make ingest DIR=./my-docs               # –ö–∞—Å—Ç–æ–º–Ω–∞—è –ø–∞–ø–∫–∞
make ingest MODEL=text-embedding-3-large # –î—Ä—É–≥–∞—è –º–æ–¥–µ–ª—å

# –ü–æ–∏—Å–∫
make search Q="–∑–∞–ø—Ä–æ—Å"                   # –ë–∞–∑–æ–≤—ã–π –ø–æ–∏—Å–∫
make search Q="AI" K=10                  # –¢–æ–ø-10 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
make search Q="ML" K=5 LANG=ru          # –° —Ñ–∏–ª—å—Ç—Ä–æ–º —è–∑—ã–∫–∞
```

### Docker —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```bash
make docker-up      # –ó–∞–ø—É—Å–∫ Qdrant
make docker-down    # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ Qdrant
make docker-logs    # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
make docker-clean   # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ + –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
make test           # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
make lint           # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ + –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
make fmt            # –¢–æ–ª—å–∫–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
make vet            # –¢–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
make tidy           # –û—á–∏—Å—Ç–∫–∞ go.mod
```

### –û—á–∏—Å—Ç–∫–∞
```bash
make clean          # –£–¥–∞–ª–µ–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤
make clean-all      # –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (+ Docker –¥–∞–Ω–Ω—ã–µ + mod cache)
```

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è
export OPENAI_API_KEY=sk-your-key

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (—Å –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
DIR=./html                    # –ü–∞–ø–∫–∞ —Å HTML —Ñ–∞–π–ª–∞–º–∏
MODEL=text-embedding-3-small  # –ú–æ–¥–µ–ª—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
QDRANT=localhost:6334         # –ê–¥—Ä–µ—Å Qdrant gRPC
K=5                          # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
LANG=                        # –§–∏–ª—å—Ç—Ä —è–∑—ã–∫–∞ (–ø—É—Å—Ç–æ–π = –≤—Å–µ —è–∑—ã–∫–∏)
```

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```bash
# –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
make setup
make docker-up
export OPENAI_API_KEY=sk-...
make ingest DIR=./docs MODEL=text-embedding-3-large
make search Q="–≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö" K=10

# –ë—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
make build && ./bin/test-ragger -mode=search -q="test" -k=3

# –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º
make docker-logs
make lint
make clean-all && make setup
```

## üéØ –ü–æ–ª–µ–∑–Ω—ã–µ —Ñ–∏—à–∫–∏

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π GOPROXY**: Makefile –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π –ø—Ä–æ–∫—Å–∏
2. **–£–º–Ω–∞—è —Å–±–æ—Ä–∫–∞**: –°–æ–∑–¥–∞–µ—Ç –ø–∞–ø–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, Q –¥–ª—è search)
4. **–≠–º–æ–¥–∑–∏ –∏ —Ü–≤–µ—Ç–∞**: –£–¥–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ —Å –∏–∫–æ–Ω–∫–∞–º–∏
5. **–°–ø—Ä–∞–≤–∫–∞**: `make help` –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
